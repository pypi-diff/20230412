# Comparing `tmp/viur_core-3.4.0b2-py3-none-any.whl.zip` & `tmp/viur_core-3.4.0b3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,94 +1,94 @@
-Zip file size: 245527 bytes, number of entries: 92
--rw-r--r--  2.0 unx    18791 b- defN 23-Apr-03 19:37 viur/requirements.txt
+Zip file size: 245739 bytes, number of entries: 92
+-rw-r--r--  2.0 unx    18791 b- defN 23-Apr-12 09:16 viur/requirements.txt
 -rw-r--r--  2.0 unx      304 b- defN 23-Mar-09 16:34 viur/tox.ini
--rw-r--r--  2.0 unx    16000 b- defN 23-Apr-03 09:53 viur/core/__init__.py
+-rw-r--r--  2.0 unx    16000 b- defN 23-Apr-12 09:16 viur/core/__init__.py
 -rw-r--r--  2.0 unx    13627 b- defN 23-Mar-09 16:34 viur/core/cache.py
--rw-r--r--  2.0 unx    12307 b- defN 23-Apr-03 09:53 viur/core/config.py
+-rw-r--r--  2.0 unx    12307 b- defN 23-Apr-12 15:13 viur/core/config.py
 -rw-r--r--  2.0 unx      272 b- defN 23-Mar-09 16:34 viur/core/current.py
 -rw-r--r--  2.0 unx      579 b- defN 23-Jan-18 08:13 viur/core/db.py
 -rw-r--r--  2.0 unx    17528 b- defN 23-Jan-18 08:13 viur/core/email.py
 -rw-r--r--  2.0 unx     7048 b- defN 23-Jan-18 08:13 viur/core/errors.py
 -rw-r--r--  2.0 unx    12654 b- defN 23-Mar-09 16:34 viur/core/i18n.py
 -rw-r--r--  2.0 unx     6360 b- defN 23-Mar-09 16:34 viur/core/logging.py
--rw-r--r--  2.0 unx     7185 b- defN 23-Mar-09 16:34 viur/core/module.py
+-rw-r--r--  2.0 unx     7185 b- defN 23-Apr-12 10:11 viur/core/module.py
 -rw-r--r--  2.0 unx     6141 b- defN 22-Dec-08 12:57 viur/core/pagination.py
 -rw-r--r--  2.0 unx     5647 b- defN 23-Mar-09 16:34 viur/core/ratelimit.py
--rw-r--r--  2.0 unx    32926 b- defN 23-Apr-03 09:53 viur/core/request.py
+-rw-r--r--  2.0 unx    32926 b- defN 23-Apr-12 09:16 viur/core/request.py
 -rw-r--r--  2.0 unx    14954 b- defN 23-Mar-09 16:34 viur/core/securityheaders.py
--rw-r--r--  2.0 unx     4651 b- defN 23-Apr-03 09:53 viur/core/securitykey.py
--rw-r--r--  2.0 unx    10338 b- defN 23-Apr-03 09:53 viur/core/session.py
--rw-r--r--  2.0 unx    71084 b- defN 23-Apr-03 19:37 viur/core/skeleton.py
--rw-r--r--  2.0 unx    33528 b- defN 23-Apr-03 09:53 viur/core/tasks.py
--rw-r--r--  2.0 unx    12355 b- defN 23-Apr-03 09:53 viur/core/utils.py
--rw-r--r--  2.0 unx       28 b- defN 23-Apr-03 19:41 viur/core/version.py
--rw-r--r--  2.0 unx     2765 b- defN 23-Apr-03 19:37 viur/core/bones/__init__.py
--rw-r--r--  2.0 unx    42403 b- defN 23-Apr-03 19:37 viur/core/bones/base.py
+-rw-r--r--  2.0 unx     4651 b- defN 23-Apr-12 09:16 viur/core/securitykey.py
+-rw-r--r--  2.0 unx    10338 b- defN 23-Apr-12 09:16 viur/core/session.py
+-rw-r--r--  2.0 unx    71253 b- defN 23-Apr-12 12:35 viur/core/skeleton.py
+-rw-r--r--  2.0 unx    33528 b- defN 23-Apr-12 09:16 viur/core/tasks.py
+-rw-r--r--  2.0 unx    12355 b- defN 23-Apr-12 09:16 viur/core/utils.py
+-rw-r--r--  2.0 unx       28 b- defN 23-Apr-12 15:13 viur/core/version.py
+-rw-r--r--  2.0 unx     2765 b- defN 23-Apr-12 09:16 viur/core/bones/__init__.py
+-rw-r--r--  2.0 unx    42403 b- defN 23-Apr-05 22:28 viur/core/bones/base.py
 -rw-r--r--  2.0 unx     1871 b- defN 23-Mar-09 16:27 viur/core/bones/boolean.py
 -rw-r--r--  2.0 unx     2742 b- defN 23-Mar-09 16:34 viur/core/bones/captcha.py
 -rw-r--r--  2.0 unx     1910 b- defN 23-Mar-09 16:27 viur/core/bones/color.py
 -rw-r--r--  2.0 unx     1538 b- defN 23-Mar-09 16:27 viur/core/bones/credential.py
--rw-r--r--  2.0 unx    12137 b- defN 23-Apr-03 09:53 viur/core/bones/date.py
+-rw-r--r--  2.0 unx    12790 b- defN 23-Apr-12 09:16 viur/core/bones/date.py
 -rw-r--r--  2.0 unx     1211 b- defN 23-Mar-09 16:27 viur/core/bones/email.py
--rw-r--r--  2.0 unx     8870 b- defN 23-Apr-03 09:53 viur/core/bones/file.py
--rw-r--r--  2.0 unx     3268 b- defN 23-Apr-03 09:53 viur/core/bones/json.py
+-rw-r--r--  2.0 unx     8870 b- defN 23-Apr-12 09:16 viur/core/bones/file.py
+-rw-r--r--  2.0 unx     3268 b- defN 23-Apr-12 09:16 viur/core/bones/json.py
 -rw-r--r--  2.0 unx     7115 b- defN 23-Mar-09 16:27 viur/core/bones/key.py
--rw-r--r--  2.0 unx     6703 b- defN 23-Apr-03 09:53 viur/core/bones/numeric.py
--rw-r--r--  2.0 unx     5806 b- defN 23-Apr-03 09:53 viur/core/bones/password.py
+-rw-r--r--  2.0 unx     6703 b- defN 23-Apr-12 09:16 viur/core/bones/numeric.py
+-rw-r--r--  2.0 unx     5806 b- defN 23-Apr-12 09:16 viur/core/bones/password.py
 -rw-r--r--  2.0 unx     6453 b- defN 23-Mar-09 16:27 viur/core/bones/randomslice.py
 -rw-r--r--  2.0 unx      873 b- defN 23-Mar-09 16:27 viur/core/bones/raw.py
 -rw-r--r--  2.0 unx     4415 b- defN 23-Mar-09 16:34 viur/core/bones/record.py
 -rw-r--r--  2.0 unx    48776 b- defN 23-Mar-09 16:34 viur/core/bones/relational.py
--rw-r--r--  2.0 unx     3209 b- defN 23-Apr-03 09:53 viur/core/bones/select.py
+-rw-r--r--  2.0 unx     3209 b- defN 23-Apr-12 09:16 viur/core/bones/select.py
 -rw-r--r--  2.0 unx    16814 b- defN 23-Mar-09 16:27 viur/core/bones/selectcountry.py
 -rw-r--r--  2.0 unx      505 b- defN 23-Mar-09 16:27 viur/core/bones/sortindex.py
 -rw-r--r--  2.0 unx    16500 b- defN 23-Mar-09 16:34 viur/core/bones/spatial.py
 -rw-r--r--  2.0 unx     7374 b- defN 23-Mar-09 16:34 viur/core/bones/string.py
--rw-r--r--  2.0 unx    16275 b- defN 23-Apr-03 09:53 viur/core/bones/text.py
+-rw-r--r--  2.0 unx    16275 b- defN 23-Apr-12 09:16 viur/core/bones/text.py
 -rw-r--r--  2.0 unx      214 b- defN 22-Dec-08 12:57 viur/core/bones/treeleaf.py
 -rw-r--r--  2.0 unx      126 b- defN 22-Dec-08 12:57 viur/core/bones/treenode.py
 -rw-r--r--  2.0 unx     1074 b- defN 23-Mar-09 16:34 viur/core/bones/user.py
 -rw-r--r--  2.0 unx       38 b- defN 23-Jan-18 08:13 viur/core/languages/__init__.py
--rw-r--r--  2.0 unx    12666 b- defN 23-Apr-03 09:53 viur/core/languages/de.py
--rw-r--r--  2.0 unx     1660 b- defN 23-Mar-01 22:09 viur/core/languages/en.py
+-rw-r--r--  2.0 unx    12666 b- defN 23-Apr-12 10:11 viur/core/languages/de.py
+-rw-r--r--  2.0 unx     1660 b- defN 23-Apr-12 10:11 viur/core/languages/en.py
 -rw-r--r--  2.0 unx        0 b- defN 22-Dec-08 12:57 viur/core/modules/__init__.py
--rw-r--r--  2.0 unx    33478 b- defN 23-Apr-03 09:53 viur/core/modules/file.py
--rw-r--r--  2.0 unx     1916 b- defN 23-Mar-09 16:34 viur/core/modules/formmailer.py
+-rw-r--r--  2.0 unx    33478 b- defN 23-Apr-12 09:16 viur/core/modules/file.py
+-rw-r--r--  2.0 unx     1916 b- defN 23-Apr-11 20:12 viur/core/modules/formmailer.py
 -rw-r--r--  2.0 unx     2502 b- defN 23-Mar-09 16:34 viur/core/modules/moduleconf.py
--rw-r--r--  2.0 unx      973 b- defN 23-Apr-03 09:53 viur/core/modules/page.py
--rw-r--r--  2.0 unx     4071 b- defN 23-Apr-03 09:53 viur/core/modules/script.py
+-rw-r--r--  2.0 unx      973 b- defN 23-Apr-12 09:16 viur/core/modules/page.py
+-rw-r--r--  2.0 unx     4071 b- defN 23-Apr-12 09:16 viur/core/modules/script.py
 -rw-r--r--  2.0 unx      556 b- defN 22-Dec-08 12:57 viur/core/modules/site.py
--rw-r--r--  2.0 unx    41728 b- defN 23-Apr-03 09:53 viur/core/modules/user.py
--rw-r--r--  2.0 unx      816 b- defN 23-Apr-03 09:53 viur/core/prototypes/__init__.py
--rw-r--r--  2.0 unx    22782 b- defN 23-Apr-03 09:53 viur/core/prototypes/list.py
--rw-r--r--  2.0 unx    10123 b- defN 23-Apr-03 09:53 viur/core/prototypes/singleton.py
--rw-r--r--  2.0 unx     2897 b- defN 23-Mar-09 16:34 viur/core/prototypes/skelmodule.py
--rw-r--r--  2.0 unx    34002 b- defN 23-Apr-03 09:53 viur/core/prototypes/tree.py
+-rw-r--r--  2.0 unx    41728 b- defN 23-Apr-12 10:11 viur/core/modules/user.py
+-rw-r--r--  2.0 unx      816 b- defN 23-Apr-12 09:16 viur/core/prototypes/__init__.py
+-rw-r--r--  2.0 unx    22782 b- defN 23-Apr-12 09:16 viur/core/prototypes/list.py
+-rw-r--r--  2.0 unx    10123 b- defN 23-Apr-12 09:16 viur/core/prototypes/singleton.py
+-rw-r--r--  2.0 unx     2897 b- defN 23-Apr-12 10:11 viur/core/prototypes/skelmodule.py
+-rw-r--r--  2.0 unx    34002 b- defN 23-Apr-12 09:16 viur/core/prototypes/tree.py
 -rw-r--r--  2.0 unx      204 b- defN 23-Mar-09 16:34 viur/core/render/__init__.py
 -rw-r--r--  2.0 unx      169 b- defN 23-Jan-18 08:13 viur/core/render/html/__init__.py
 -rw-r--r--  2.0 unx    19850 b- defN 23-Mar-09 16:34 viur/core/render/html/default.py
 -rw-r--r--  2.0 unx     3584 b- defN 22-Dec-08 12:57 viur/core/render/html/user.py
 -rw-r--r--  2.0 unx     1949 b- defN 23-Jan-18 08:13 viur/core/render/html/utils.py
 -rw-r--r--  2.0 unx      142 b- defN 23-Jan-18 08:13 viur/core/render/html/env/__init__.py
 -rw-r--r--  2.0 unx      942 b- defN 22-Dec-08 12:57 viur/core/render/html/env/date.py
 -rw-r--r--  2.0 unx     1353 b- defN 22-Dec-08 12:57 viur/core/render/html/env/debug.py
 -rw-r--r--  2.0 unx     1753 b- defN 22-Dec-08 12:57 viur/core/render/html/env/regex.py
 -rw-r--r--  2.0 unx     1161 b- defN 23-Mar-09 16:34 viur/core/render/html/env/session.py
 -rw-r--r--  2.0 unx      540 b- defN 22-Dec-08 12:57 viur/core/render/html/env/strings.py
 -rw-r--r--  2.0 unx      435 b- defN 23-Jan-18 08:13 viur/core/render/html/env/tests.py
--rw-r--r--  2.0 unx    25465 b- defN 23-Apr-03 09:53 viur/core/render/html/env/viur.py
+-rw-r--r--  2.0 unx    25465 b- defN 23-Apr-12 09:16 viur/core/render/html/env/viur.py
 -rw-r--r--  2.0 unx      353 b- defN 22-Dec-09 18:29 viur/core/render/json/__init__.py
--rw-r--r--  2.0 unx     8535 b- defN 23-Apr-03 09:53 viur/core/render/json/default.py
+-rw-r--r--  2.0 unx     8699 b- defN 23-Apr-12 12:35 viur/core/render/json/default.py
 -rw-r--r--  2.0 unx      963 b- defN 23-Jan-18 08:13 viur/core/render/json/user.py
--rw-r--r--  2.0 unx     5562 b- defN 23-Mar-09 16:34 viur/core/render/vi/__init__.py
+-rw-r--r--  2.0 unx     5562 b- defN 23-Apr-11 20:12 viur/core/render/vi/__init__.py
 -rw-r--r--  2.0 unx      899 b- defN 22-Dec-08 12:57 viur/core/render/vi/user.py
 -rw-r--r--  2.0 unx     1046 b- defN 23-Mar-09 16:34 viur/core/render/xml/__init__.py
 -rw-r--r--  2.0 unx     7319 b- defN 23-Mar-09 16:34 viur/core/render/xml/default.py
 -rw-r--r--  2.0 unx      957 b- defN 22-Dec-08 12:57 viur/core/render/xml/user.py
--rw-r--r--  2.0 unx     7644 b- defN 23-Apr-03 09:53 viur/core/template/error.html
+-rw-r--r--  2.0 unx     7644 b- defN 23-Apr-12 09:16 viur/core/template/error.html
 -rw-r--r--  2.0 unx     1083 b- defN 22-Dec-08 12:57 viur/core/template/vi_user_google_login.html
--rw-r--r--  2.0 unx     7651 b- defN 23-Apr-03 19:41 viur_core-3.4.0b2.dist-info/LICENSE
--rw-r--r--  2.0 unx     5025 b- defN 23-Apr-03 19:41 viur_core-3.4.0b2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Apr-03 19:41 viur_core-3.4.0b2.dist-info/WHEEL
--rw-r--r--  2.0 unx        5 b- defN 23-Apr-03 19:41 viur_core-3.4.0b2.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     7660 b- defN 23-Apr-03 19:41 viur_core-3.4.0b2.dist-info/RECORD
-92 files, 807803 bytes uncompressed, 233561 bytes compressed:  71.1%
+-rw-r--r--  2.0 unx     7651 b- defN 23-Apr-12 15:15 viur_core-3.4.0b3.dist-info/LICENSE
+-rw-r--r--  2.0 unx     5025 b- defN 23-Apr-12 15:15 viur_core-3.4.0b3.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Apr-12 15:15 viur_core-3.4.0b3.dist-info/WHEEL
+-rw-r--r--  2.0 unx        5 b- defN 23-Apr-12 15:15 viur_core-3.4.0b3.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     7660 b- defN 23-Apr-12 15:15 viur_core-3.4.0b3.dist-info/RECORD
+92 files, 808789 bytes uncompressed, 233773 bytes compressed:  71.1%
```

## zipnote {}

```diff
@@ -255,23 +255,23 @@
 
 Filename: viur/core/template/error.html
 Comment: 
 
 Filename: viur/core/template/vi_user_google_login.html
 Comment: 
 
-Filename: viur_core-3.4.0b2.dist-info/LICENSE
+Filename: viur_core-3.4.0b3.dist-info/LICENSE
 Comment: 
 
-Filename: viur_core-3.4.0b2.dist-info/METADATA
+Filename: viur_core-3.4.0b3.dist-info/METADATA
 Comment: 
 
-Filename: viur_core-3.4.0b2.dist-info/WHEEL
+Filename: viur_core-3.4.0b3.dist-info/WHEEL
 Comment: 
 
-Filename: viur_core-3.4.0b2.dist-info/top_level.txt
+Filename: viur_core-3.4.0b3.dist-info/top_level.txt
 Comment: 
 
-Filename: viur_core-3.4.0b2.dist-info/RECORD
+Filename: viur_core-3.4.0b3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## viur/core/skeleton.py

```diff
@@ -251,15 +251,18 @@
 
     def setEntity(self, entity: db.Entity):
         self.dbEntity = entity
         self.accessedValues = {}
         self.renderAccessedValues = {}
 
     def structure(self) -> dict:
-        return {key: bone.structure() for key, bone in self.items()}
+        return {
+            key: bone.structure() | {"sortindex": i}
+            for i, (key, bone) in enumerate(self.items())
+        }
 
     def __deepcopy__(self, memodict):
         res = self.clone()
         memodict[id(self)] = res
         return res
 
 
@@ -1279,23 +1282,30 @@
         SkelLists are returned by Skel().all()...fetch()-constructs and provide additional information
         about the data base query, for fetching additional entries.
 
         :ivar cursor: Holds the cursor within a query.
         :vartype cursor: str
     """
 
-    __slots__ = ["baseSkel", "getCursor", "customQueryInfo", "renderPreparation"]
+    __slots__ = (
+        "baseSkel",
+        "customQueryInfo",
+        "getCursor",
+        "get_orders",
+        "renderPreparation",
+    )
 
     def __init__(self, baseSkel=None):
         """
             :param baseSkel: The baseclass for all entries in this list
         """
         super(SkelList, self).__init__()
         self.baseSkel = baseSkel or {}
         self.getCursor = lambda: None
+        self.get_orders = lambda: None
         self.renderPreparation = None
         self.customQueryInfo = {}
 
 
 ### Tasks ###
 
 @CallDeferred
```

## viur/core/version.py

```diff
@@ -1 +1 @@
-__version__ = "3.4.0-beta2"
+__version__ = "3.4.0-beta3"
```

## viur/core/bones/date.py

```diff
@@ -1,64 +1,73 @@
+from datetime import datetime, timedelta, timezone
+from typing import Dict, Optional
+
+import pytz
+import tzlocal
+
+from viur.core import conf, current, db
 from viur.core.bones.base import BaseBone, ReadFromClientError, ReadFromClientErrorSeverity
-from viur.core import db, request, conf, current
 from viur.core.utils import utcNow
-from datetime import datetime, timedelta
-from typing import Dict, Optional
-import pytz, tzlocal
 
 
 class DateBone(BaseBone):
     type = "date"
 
     def __init__(
         self,
         *,
         creationMagic: bool = False,
         date: bool = True,
         localize: bool = None,
+        naive: bool = False,
         time: bool = True,
         updateMagic: bool = False,
         **kwargs
     ):
         """
             Initializes a new DateBone.
 
             :param creationMagic: Use the current time as value when creating an entity; ignoring this bone if the
                 entity gets updated.
             :param updateMagic: Use the current time whenever this entity is saved.
             :param date: Should this bone contain a date-information?
             :param time: Should this bone contain time information?
             :param localize: Assume users timezone for in and output? Only valid if this bone
                                 contains date and time-information! Per default, UTC time is used.
+            :param naive: Use naive datetime for this bone, the default is aware.
         """
         super().__init__(**kwargs)
 
         # Either date or time must be set
         if not (date or time):
             raise ValueError("Attempt to create an empty DateBone! Set date or time to True!")
 
         # Localize-flag only possible with date and time
         if localize and not (date and time):
             raise ValueError("Localization is only possible with date and time!")
         # Default localize all DateBones, if not explicitly defined
-        elif localize is None:
+        elif localize is None and not naive:
             localize = date and time
 
+        if naive and localize:
+            raise ValueError("Localize and naive is not possible!")
+
         # Magic is only possible in non-multiple bones and why ever only on readonly bones...
         if creationMagic or updateMagic:
             if self.multiple:
                 raise ValueError("Cannot be multiple and have a creation/update-magic set!")
 
             self.readonly = True  # todo: why???
 
         self.creationMagic = creationMagic
         self.updateMagic = updateMagic
         self.date = date
         self.time = time
         self.localize = localize
+        self.naive = naive
 
     def singleValueFromClient(self, value: str, skel: 'viur.core.skeleton.SkeletonInstance', name: str, origData):
         """
             Reads a value from the client.
             If this value is valid for this bone,
             store this value and return None.
             Otherwise our previous value is
@@ -98,15 +107,17 @@
         if str(rawValue).replace("-", "", 1).replace(".", "", 1).isdigit():
             if int(rawValue) < -1 * (2 ** 30) or int(rawValue) > (2 ** 31) - 2:
                 value = False  # its invalid
             else:
                 value = datetime.fromtimestamp(float(rawValue), tz=time_zone).replace(microsecond=0)
         elif not self.date and self.time:
             try:
-                value = time_zone.localize(datetime.fromisoformat(value))
+                value = datetime.fromisoformat(value)
+                if not self.naive:
+                    value = time_zone.localize(value)
             except:
                 try:
                     if str(rawValue).count(":") > 1:
                         (hour, minute, second) = [int(x.strip()) for x in str(rawValue).split(":")]
                         value = datetime(year=1970, month=1, day=1, hour=hour, minute=minute, second=second,
                                          tzinfo=time_zone)
                     elif str(rawValue).count(":") > 0:
@@ -124,41 +135,43 @@
                 try:
                     tmpRes += timedelta(seconds=int(str(rawValue)[3:]))
                 except:
                     pass
             value = tmpRes
         else:
             try:
-                value = time_zone.localize(datetime.fromisoformat(value))
+                value = datetime.fromisoformat(value)
             except:
                 try:
                     if " " in rawValue:  # Date with time
                         try:  # Times with seconds
                             if "-" in rawValue:  # ISO Date
-                                value = time_zone.localize(datetime.strptime(str(rawValue), "%Y-%m-%d %H:%M:%S"))
+                                value = datetime.strptime(str(rawValue), "%Y-%m-%d %H:%M:%S")
                             elif "/" in rawValue:  # Ami Date
-                                value = time_zone.localize(datetime.strptime(str(rawValue), "%m/%d/%Y %H:%M:%S"))
+                                value = datetime.strptime(str(rawValue), "%m/%d/%Y %H:%M:%S")
                             else:  # European Date
-                                value = time_zone.localize(datetime.strptime(str(rawValue), "%d.%m.%Y %H:%M:%S"))
+                                value = datetime.strptime(str(rawValue), "%d.%m.%Y %H:%M:%S")
                         except:
                             if "-" in rawValue:  # ISO Date
-                                value = time_zone.localize(datetime.strptime(str(rawValue), "%Y-%m-%d %H:%M"))
+                                value = datetime.strptime(str(rawValue), "%Y-%m-%d %H:%M")
                             elif "/" in rawValue:  # Ami Date
-                                value = time_zone.localize(datetime.strptime(str(rawValue), "%m/%d/%Y %H:%M"))
+                                value = datetime.strptime(str(rawValue), "%m/%d/%Y %H:%M")
                             else:  # European Date
-                                value = time_zone.localize(datetime.strptime(str(rawValue), "%d.%m.%Y %H:%M"))
+                                value = datetime.strptime(str(rawValue), "%d.%m.%Y %H:%M")
                     else:
                         if "-" in rawValue:  # ISO (Date only)
-                            value = time_zone.localize(datetime.strptime(str(rawValue), "%Y-%m-%d"))
+                            value = datetime.strptime(str(rawValue), "%Y-%m-%d")
                         elif "/" in rawValue:  # Ami (Date only)
-                            value = time_zone.localize(datetime.strptime(str(rawValue), "%m/%d/%Y"))
+                            value = datetime.strptime(str(rawValue), "%m/%d/%Y")
                         else:  # European (Date only)
-                            value = time_zone.localize(datetime.strptime(str(rawValue), "%d.%m.%Y"))
+                            value = datetime.strptime(str(rawValue), "%d.%m.%Y")
                 except:
                     value = False  # its invalid
+            if value and not self.naive:
+                value = time_zone.localize(value)
         if value is False:
             return self.getEmptyValue(), [
                 ReadFromClientError(ReadFromClientErrorSeverity.Invalid, "Invalid value entered")]
         value = value.replace(microsecond=0)
         err = self.isInvalid(value)
         if err:
             return self.getEmptyValue(), [ReadFromClientError(ReadFromClientErrorSeverity.Invalid, err)]
@@ -177,14 +190,16 @@
 
     def guessTimeZone(self):
         """
         Guess the timezone the user is supposed to be in.
         If not both date and time are set and the localize flag is set, then UTC is used.
         If it cant be guessed, a safe default (UTC) is used
         """
+        if self.naive:
+            return None
         if not (self.date and self.time and self.localize):
             return pytz.utc
 
         if conf["viur.instance.is_dev_server"]:
             return tzlocal.get_localzone()
 
         timeZone = pytz.utc  # Default fallback
@@ -219,29 +234,34 @@
         if value:
             # Crop unwanted values to zero
             value = value.replace(microsecond=0)
             if not self.time:
                 value = value.replace(hour=0, minute=0, second=0)
             elif not self.date:
                 value = value.replace(year=1970, month=1, day=1)
+            if self.naive:
+                value = value.replace(tzinfo=timezone.utc)
             # We should always deal with timezone aware datetimes
             assert value.tzinfo, "Encountered a naive Datetime object in %s - refusing to save." % name
         return value
 
     def singleValueUnserialize(self, value):
         if isinstance(value, datetime):
             # Serialized value is timezone aware.
-            # If local timezone is needed, set here, else force UTC.
-            time_zone = self.guessTimeZone()
-            return value.astimezone(time_zone)
+            if self.naive:
+                value = value.replace(tzinfo=None)
+                return value
+            else:
+                # If local timezone is needed, set here, else force UTC.
+                time_zone = self.guessTimeZone()
+                return value.astimezone(time_zone)
         else:
             # We got garbage from the datastore
             return None
 
-
     def buildDBFilter(self,
                       name: str,
                       skel: 'viur.core.skeleton.SkeletonInstance',
                       dbFilter: db.Query,
                       rawFilter: Dict,
                       prefix: Optional[str] = None) -> db.Query:
         for key in [x for x in rawFilter.keys() if x.startswith(name)]:
@@ -249,14 +269,18 @@
             if not self.fromClient(resDict, key, rawFilter):  # Parsing succeeded
                 super().buildDBFilter(name, skel, dbFilter, {key: resDict[key]}, prefix=prefix)
 
         return dbFilter
 
     def performMagic(self, valuesCache, name, isAdd):
         if (self.creationMagic and isAdd) or self.updateMagic:
-            valuesCache[name] = utcNow().replace(microsecond=0).astimezone(self.guessTimeZone())
+            if self.naive:
+                valuesCache[name] = utcNow().replace(microsecond=0, tzinfo=None)
+            else:
+                valuesCache[name] = utcNow().replace(microsecond=0).astimezone(self.guessTimeZone())
 
     def structure(self) -> dict:
         return super().structure() | {
             "date": self.date,
-            "time": self.time
+            "time": self.time,
+            "naive": self.naive
         }
```

## viur/core/render/json/default.py

```diff
@@ -32,22 +32,19 @@
     def __init__(self, parent=None, *args, **kwargs):
         super(DefaultRender, self).__init__(*args, **kwargs)
         self.parent = parent
 
     @staticmethod
     def render_structure(structure: dict):
         """
-        Performs structure rewrite according to compatibility flags.
+        Performs structure rewriting according to VIUR2/3 compatibility flags.
+        # fixme: Remove this entire function with VIUR4
         """
-        for i, struct in enumerate(structure.values()):
-            # Inject sortindex as additional bone ordering indicator
-            struct["sortindex"] = i
-
+        for struct in structure.values():
             # Optionally replace new-key by a copy of the value under the old-key
-            # fixme: Remove in VIUR4
             if "json.bone.structure.camelcasenames" in conf["viur.compatibility"]:
                 for find, replace in {
                     "boundslat": "boundsLat",
                     "boundslng": "boundsLng",
                     "emptyvalue": "emptyValue",
                     "max": "maxAmount",
                     "maxlength": "maxLength",
@@ -56,16 +53,20 @@
                     "readonly": "readOnly",
                     "valid_html": "validHtml",
                     "valid_mime_types": "validMimeTypes",
                 }.items():
                     if find in struct:
                         struct[replace] = struct[find]
 
+            # Call render_structure() recursively on "using" and "relskel" members.
+            for substruct in ("using", "relskel"):
+                if substruct in struct and struct[substruct]:
+                    struct[substruct] = DefaultRender.render_structure(struct[substruct])
+
         # Optionally return list of tuples instead of dict
-        # fixme: Remove in VIUR4
         if "json.bone.structure.keytuples" in conf["viur.compatibility"]:
             return [(key, struct) for key, struct in structure.items()]
 
         return structure
 
 
     def renderSingleBoneValue(self, value: Any,
```

## Comparing `viur_core-3.4.0b2.dist-info/LICENSE` & `viur_core-3.4.0b3.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `viur_core-3.4.0b2.dist-info/METADATA` & `viur_core-3.4.0b3.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: viur-core
-Version: 3.4.0b2
+Version: 3.4.0b3
 Summary: The core component of ViUR, a development framework for Google App Engine
 Home-page: https://github.com/viur-framework/viur-core
 Author: Mausbrand Informationssysteme GmbH
 Author-email: devs@viur.dev
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: GNU Lesser General Public License v3 (LGPLv3)
```

### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: viur-core Version: 3.4.0b2 Summary: The core
+Metadata-Version: 2.1 Name: viur-core Version: 3.4.0b3 Summary: The core
 component of ViUR, a development framework for Google App Engine Home-page:
 https://github.com/viur-framework/viur-core Author: Mausbrand
 Informationssysteme GmbH Author-email: devs@viur.dev Classifier: Development
 Status :: 5 - Production/Stable Classifier: Intended Audience :: Developers
 Classifier: License :: OSI Approved :: GNU Lesser General Public License v3
 (LGPLv3) Classifier: Operating System :: OS Independent Classifier: Programming
 Language :: Python :: 3.10 Classifier: Topic :: Internet Classifier: Topic ::
```

## Comparing `viur_core-3.4.0b2.dist-info/RECORD` & `viur_core-3.4.0b3.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -12,25 +12,25 @@
 viur/core/module.py,sha256=jeswlTLpSmCvKqKlOmlsyzbHQ0rmTymbDPx75vuqAd8,7185
 viur/core/pagination.py,sha256=OmTE4gHCThpc9O0di1SbD7FtbwIDMQuABAZ0rIv2L0w,6141
 viur/core/ratelimit.py,sha256=bcoYeMjtoisK6YReQz51EFY-7F2BSwAW24qPRZg9IQc,5647
 viur/core/request.py,sha256=SzjkN4TfaxhpE5Ljh0fPOoKt6YgpV7tW3EmXYVijag4,32926
 viur/core/securityheaders.py,sha256=dJh6-VnOgpNNFEuYanDRK9mz_ctaMJEax_mX5O3uQNA,14954
 viur/core/securitykey.py,sha256=-1n2_UjsGeS6KROhVTOUyMBPgd3_tb8y6wKiFjB_pvE,4651
 viur/core/session.py,sha256=1qSRDuDlwoL15oTrNrGGNMU6NCuFchBFhzNXk3xkr1E,10338
-viur/core/skeleton.py,sha256=ua1xhWxYnDaljP9OQfQVYURjjgkJ5ULzfhY9mzahzVI,71084
+viur/core/skeleton.py,sha256=zH4cwSYTdpmF86rd-Tk8vaBw2vdk2fVRKpKDw3Y9F4c,71253
 viur/core/tasks.py,sha256=c6jVoUQYAzOjLGEJEp7KUfemzRZdmZq8wlJ6zGdIOIg,33528
 viur/core/utils.py,sha256=wUMu98DDNCyEmW1BqkB9jTuAYEr_d8ZUbDQupodM4g0,12355
-viur/core/version.py,sha256=wqnQymM6pfrKPKiED73e8H3zuesIwccooTdvw51mwSg,28
+viur/core/version.py,sha256=x694fYRAafNZEnDGJzYC9OjCrzPHWAXGI5u6x1RnhzQ,28
 viur/core/bones/__init__.py,sha256=VOVFTzFk_izcOAtBmXUnIzAE2QcMJPgYZgvhWqvyj-k,2765
 viur/core/bones/base.py,sha256=F0VzTjTXJ3MZ1ahECQuTncbqwjd32mt8BnFnLbm53yc,42403
 viur/core/bones/boolean.py,sha256=xQ12gbs_f-swALP-UyNjTqlSGVtHnRrjO1Ia8zx94EQ,1871
 viur/core/bones/captcha.py,sha256=Ei0XevzU6_eXzN8Fla2D6GcNMvc7tML_GiNKm2w86f0,2742
 viur/core/bones/color.py,sha256=aI3oPPSx33fFBDklpXVwuJS5Q0GWD_DmkBdSavb5PfE,1910
 viur/core/bones/credential.py,sha256=Mpr717hBXY4npzKBaeCe0pCXkURFfO0EG9W3SaDmvRs,1538
-viur/core/bones/date.py,sha256=uHdTY_EeXzzkC23ak-Uhj2cjO5XoE_8LOdglmWf1RLU,12137
+viur/core/bones/date.py,sha256=VJ2QYWXvUR2XUphju4KW-UdAV3b_4JNQHojn4Na82vk,12790
 viur/core/bones/email.py,sha256=YmYtC3kwqFc4GkbkYmgPI9YZmZKJex_A82jjsSzjxsM,1211
 viur/core/bones/file.py,sha256=SZtdT2sEiSSBO9FEI_-fzgzaqy8JMwXhOA2lq8UrJF4,8870
 viur/core/bones/json.py,sha256=RmY8PLVrmD7YXULycKNy_imhOyoCmAvcCyDNlvAfuoY,3268
 viur/core/bones/key.py,sha256=ykrm56C78FSCGH40pU0TX5-xn1PcYsKlNHTBwK7DrrI,7115
 viur/core/bones/numeric.py,sha256=gBpky7X7p_7Z0f6T9eEKowyN8uc7jf2Wyo6f1pMnZYc,6703
 viur/core/bones/password.py,sha256=94KubvRjk4cso1spmjc8Kk9-8AW7tZr0__5ysGRSToE,5806
 viur/core/bones/randomslice.py,sha256=A4zZj0dOYLbpiWzQ_37Fm32qHWOISUDkEAS6_7qmvlc,6453
@@ -72,21 +72,21 @@
 viur/core/render/html/env/debug.py,sha256=2fFWkku56cy05xSLfYh2m46GgiAiQgxrWWDViLsapYE,1353
 viur/core/render/html/env/regex.py,sha256=bZn9HS-ELmRRNpGxSMkXit720Gy7oNo6dT5yrGaQi5E,1753
 viur/core/render/html/env/session.py,sha256=Y9tOE1GH4C3TdkNaMLKlD1hufnHJsd9tjgVt5zQu8cg,1161
 viur/core/render/html/env/strings.py,sha256=9by8IFF7gDWIbFOOUfZ5NxSbNctquGTdHU-I68vWs7I,540
 viur/core/render/html/env/tests.py,sha256=dBQ5pk1dDuqlzkIDxkhtfiMVLNOFcVJgaf4A4ssxLCc,435
 viur/core/render/html/env/viur.py,sha256=CuvPihAwdcO81zrxrzfuLeOX3bhC0ngOtcHjjS-769I,25465
 viur/core/render/json/__init__.py,sha256=JJ-zRY8USlCL9_Es9PogBnh6OapRDdN0iQ4Bxwpos_0,353
-viur/core/render/json/default.py,sha256=O8YW9pQicsKB-kHPwfSx8jm-feVbz8wEavhxU2MVUqc,8535
+viur/core/render/json/default.py,sha256=652Q_-jl88ePkBuZPpjkF2RLCo7stCpqKl-8QGfQyyU,8699
 viur/core/render/json/user.py,sha256=Wawazxes13Vli74wT3U03KRyHIg2_GkfsokHShVpcIA,963
 viur/core/render/vi/__init__.py,sha256=1IJFjUaUEeUw5hkEsOxLmDslkIv51ndjO58vWSytJLs,5562
 viur/core/render/vi/user.py,sha256=ZRGrfbN-bs1X5RV5KYKtiHTgVY9J1W7u0Hvo6NXltXk,899
 viur/core/render/xml/__init__.py,sha256=O5VhJ_-NTIIGyVhAYaB7osFZLpVE_pe5JbJW-39dkbo,1046
 viur/core/render/xml/default.py,sha256=FIJaaegpUbCYBCWaBS3HiFfY1CK8VuiWmPPiJa9kAog,7319
 viur/core/render/xml/user.py,sha256=HU5e21IlNh_Ev0BCEF_rguBG13P0cK2drxK53HHv5OM,957
 viur/core/template/error.html,sha256=CCDX7EduoLVBLu641ZO4Dwcv5QsJsJxnMA1E_p30ajY,7644
 viur/core/template/vi_user_google_login.html,sha256=yzFit0gQBAIy5-feRabZQZM2R3bfD-Wkk67MiUNdrcY,1083
-viur_core-3.4.0b2.dist-info/LICENSE,sha256=2n6rt7r999OuXp8iOqW9we7ORaxWncIbOwN1ILRGR2g,7651
-viur_core-3.4.0b2.dist-info/METADATA,sha256=XFgaRPYyBalSHI8o9EjvcwR760KKl8Nh5Ew7LBPjcBE,5025
-viur_core-3.4.0b2.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-viur_core-3.4.0b2.dist-info/top_level.txt,sha256=UpXSoS_clIJYncMZKAppy3WNRScHSjarTabKBOa8OeI,5
-viur_core-3.4.0b2.dist-info/RECORD,,
+viur_core-3.4.0b3.dist-info/LICENSE,sha256=2n6rt7r999OuXp8iOqW9we7ORaxWncIbOwN1ILRGR2g,7651
+viur_core-3.4.0b3.dist-info/METADATA,sha256=_dfQYxFMdGfwzuVzk-qP61x6RHIJB9MpgZSWdkMhhhc,5025
+viur_core-3.4.0b3.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+viur_core-3.4.0b3.dist-info/top_level.txt,sha256=UpXSoS_clIJYncMZKAppy3WNRScHSjarTabKBOa8OeI,5
+viur_core-3.4.0b3.dist-info/RECORD,,
```

